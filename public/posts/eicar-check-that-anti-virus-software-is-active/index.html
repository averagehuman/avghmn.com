<!doctype html><html data-current="post" lang="en"><head><meta charset="utf-8"><link rel="dns-prefetch" href="https://identity.netlify.com"><meta name="viewport" content="width=device-width,initial-scale=1"><title>EICAR - check that anti-virus software is active</title><meta name="description" content="Software development notes"><link rel="stylesheet" href="/static/fontawesome/css/all.css"><link rel="stylesheet" href="/static/css/prism.css"><link rel="stylesheet" href="/static/css/averagehuman.css"><script>window.netlifyIdentity&&window.netlifyIdentity.on("init",n=>{n||window.netlifyIdentity.on("login",()=>{document.location.href="/admin/"})});</script></head><body><header class="site-header"><div class="container"><nav class="navbar is-transparent" role="navigation" aria-label="main navigation"><div class="navbar-brand"><a class="navbar-item is-size-4 has-text-white" href="/"><strong>average blog</strong></a></div><div id="navbarBasicExample" class="navbar-menu"><div class="navbar-end"><div class="navbar-item"><div class="buttons"><a class="button" href="/" title="Home"><span class="icon"><i class="fas fa-lg fa-home"></i></span> </a><a class="button" href="/feed.xml" title="RSS Feed"><span class="icon"><i class="fas fa-lg fa-rss"></i></span> </a><a class="button" href="https://github.com/averagehuman" title="Github"><span class="icon"><i class="fab fa-2x fa-github" style="font-size:1.75em"></i></span></a></div></div></div></div></nav></div></header><main><div class="container"><div class="page-container"><article><h1 class="is-size-4">EICAR - check that anti-virus software is active</h1><p class="has-text-grey is-italic"><small><time datetime="2022-02-12">12 Feb 2022</time></small></p><hr><p>The EICAR Test Virus is a short text file developed by the <a href="http://www.eicar.org">European Institute for Computer Anti-Virus Research (EICAR)</a> for testing anitvirus software. It is a valid DOS program and produces sensible results when run (it prints EICAR-STANDARD-ANTIVIRUS-TEST-FILE!).</p><p>Although it is entirely safe, all correctly functioning virus scanners should flag any file that contains EICAR as malicious.</p><h2 id="programmatic-checks">Programmatic Checks</h2><p>A small difficulty when including the EICAR virus in a program or script is that the script itself, once written to disk, can then be deleted or quarantined by the very virus scanner that you are trying to check. So it is is necessary to store the EICAR text in encoded form and decode on the fly as required.</p><p>For example, with <a href="https://en.wikipedia.org/wiki/ROT13">ROT13</a> encoding, the virus text looks like:</p><pre class="language-bash"><code class="language-bash">    K5B<span class="token operator">!</span>C%@NC<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">\</span>CMK54<span class="token punctuation">(</span>C^<span class="token punctuation">)</span>7PP<span class="token punctuation">)</span><span class="token number">7</span><span class="token punctuation">}</span><span class="token variable">$RVPNE</span>-FGNAQNEQ-NAGVIVEHF-GRFG-SVYR<span class="token operator">!</span><span class="token variable">$U</span>+U*</code></pre><p>And you could decode this with bash say, as follows:</p><pre class="language-bash"><code class="language-bash"><br>    $ <span class="token builtin class-name">echo</span> <span class="token string">'K5B!C%@NC[4\CMK54(C^)7PP)7}$RVPNE-FGNAQNEQ-NAGVIVEHF-GRFG-SVYR!$U+U*'</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'[A-Za-z]'</span> <span class="token string">'[N-ZA-Mn-za-m]'</span> <span class="token operator">></span> EICAR.txt<br></code></pre><h2 id="example%3A-file-upload">Example: file upload</h2><p>To test uploading malicious files to a web server with curl, read the decoded file from stdin rather than disk:</p><pre class="language-bash"><code class="language-bash"><br>    $ <span class="token assign-left variable">EICAR</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> 'K5B<span class="token operator">!</span>C%@NC<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">\</span>CMK54<span class="token punctuation">(</span>C^<span class="token punctuation">)</span>7PP<span class="token variable">)</span></span><span class="token number">7</span><span class="token punctuation">}</span><span class="token variable">$RVPNE</span>-FGNAQNEQ-NAGVIVEHF-GRFG-SVYR<span class="token operator">!</span><span class="token variable">$U</span>+U*<span class="token string">' | tr '</span><span class="token punctuation">[</span>A-Za-z<span class="token punctuation">]</span><span class="token string">' '</span><span class="token punctuation">[</span>N-ZA-Mn-za-m<span class="token punctuation">]</span>'<span class="token punctuation">)</span><br>    $ <span class="token builtin class-name">echo</span> -n <span class="token string">"<span class="token variable">$EICAR</span>"</span> <span class="token operator">|</span> <span class="token function">curl</span> -s -i -X POST -F <span class="token string">"somefield=@-;filename=image.png"</span> http://<span class="token operator">&lt;</span>SOME URL<span class="token operator">></span><br></code></pre><p>The key here is <code>somefield=@-</code>, which causes curl to read from stdin. <code>somefield</code> is just the name of the form field expected by the web server.</p></article></div></div></main><footer class="footer"><div class="content container"><p><small>Copyright avghmn.com 2022. All rights reserved.</small></p></div></footer></body></html>